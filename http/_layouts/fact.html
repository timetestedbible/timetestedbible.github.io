---
---
<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{page.title}} - {{site.title}}</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="{{ site.title }}" property="og:site_name"/>
    
    <meta content="{{ page.title }}" property="og:title"/>
    <meta content="article" property="og:type"/>
    <meta content="{{ site.url }}{{ page.url }}" property="og:url"/>
    <meta content="{{ page.statement }}" property="og:description"/> 

    <link rel="canonical" href="{{site.url}}{{page.url}}"/>
    <link rel="icon" href="{{site.favicon}}" type="image/png" sizes="16x16"/>
    <link href="/assets/css/style.css" rel="stylesheet" media="all" class="default"/>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/>
    <link href="/assets/css/book.css" rel="stylesheet" media="all"/>
    
    {% seo %}
</head>

<body>
    <div class="container">                    
        <div class="box">
            {%- include header.html -%}
            
            <main class="fact-content">
                <nav class="fact-nav">
                    <a href="/facts/" class="facts-index">&larr; All Facts</a>
                    <a href="/explorer/" class="explorer-link">Fact Explorer</a>
                </nav>

                <article class="fact-article">
                    <header class="fact-header">
                        <h1>{{ page.title }}</h1>
                        {% if page.rejected %}
                        <span class="rejected-badge">REJECTED</span>
                        {% endif %}
                        <span class="confidence-badge {{ page.confidence | downcase | replace: ' ', '-' }}">
                            {{ page.confidence }}
                        </span>
                        {% if page.level %}
                        <span class="level-badge">Level {{ page.level }}</span>
                        {% endif %}
                    </header>

                    <!-- Fact Statement -->
                    <section class="fact-statement">
                        <h2>Fact</h2>
                        <p class="statement">{{ page.statement }}</p>
                    </section>

                    <!-- Evidence -->
                    {% if page.evidence and page.evidence.size > 0 %}
                    <section class="fact-evidence">
                        <h2>Evidence</h2>
                        <ul>
                        {% for item in page.evidence %}
                            <li>{{ item | markdownify }}</li>
                        {% endfor %}
                        </ul>
                    </section>
                    {% endif %}

                    <!-- Supporting Facts (linked to other facts) -->
                    {% if page.supporting_facts and page.supporting_facts.size > 0 %}
                    <section class="fact-support">
                        <h2>Supporting Facts</h2>
                        <div class="fact-links">
                        {% for fact_name in page.supporting_facts %}
                            {% assign linked_fact = site.facts | where: "name", fact_name | first %}
                            {% if linked_fact %}
                            <a href="{{ linked_fact.url }}" class="fact-link">
                                <span class="fact-name">{{ linked_fact.title }}</span>
                                <span class="confidence-badge small {{ linked_fact.confidence | downcase | replace: ' ', '-' }}">{{ linked_fact.confidence }}</span>
                            </a>
                            {% else %}
                            <span class="fact-link missing">{{ fact_name }}</span>
                            {% endif %}
                        {% endfor %}
                        </div>
                    </section>
                    {% endif %}

                    <!-- Read in Context - Links to chapters -->
                    {% if page.locations %}
                    <section class="fact-locations">
                        <h2>Read in Context</h2>
                        <ul class="location-list">
                        {% for loc in page.locations %}
                            <li>
                                <a href="/chapters/{{ loc.file }}/#{{ loc.section | slugify }}">
                                    <strong>{{ loc.section }}</strong>
                                </a>
                                {% if loc.excerpt %}
                                <p class="excerpt">"{{ loc.excerpt }}"</p>
                                {% endif %}
                            </li>
                        {% endfor %}
                        </ul>
                    </section>
                    {% endif %}

                    <!-- Dependencies (what this fact depends on) -->
                    {% if page.dependencies %}
                    <section class="fact-dependencies">
                        <h2>Depends On</h2>
                        <div class="fact-links">
                        {% for dep_name in page.dependencies %}
                            {% assign dep = site.facts | where: "name", dep_name | first %}
                            {% if dep %}
                            <a href="{{ dep.url }}" class="fact-link">
                                <span class="fact-name">{{ dep.title }}</span>
                                <span class="confidence-badge small {{ dep.confidence | downcase | replace: ' ', '-' }}">{{ dep.confidence }}</span>
                            </a>
                            {% else %}
                            <span class="fact-link missing">{{ dep_name }}</span>
                            {% endif %}
                        {% endfor %}
                        </div>
                    </section>
                    {% endif %}

                    <!-- Dependents (what facts depend on this) -->
                    {% assign dependents = site.facts | where_exp: "f", "f.dependencies contains page.name" %}
                    {% if dependents.size > 0 %}
                    <section class="fact-dependents">
                        <h2>Required By</h2>
                        <div class="fact-links">
                        {% for dep in dependents %}
                            <a href="{{ dep.url }}" class="fact-link">
                                <span class="fact-name">{{ dep.title }}</span>
                                <span class="confidence-badge small {{ dep.confidence | downcase | replace: ' ', '-' }}">{{ dep.confidence }}</span>
                            </a>
                        {% endfor %}
                        </div>
                    </section>
                    {% endif %}

                    <!-- For rejected facts: show why rejected and what was accepted instead -->
                    {% if page.rejected %}
                    <section class="fact-rejection-info">
                        <h2>Why This Interpretation Is Rejected</h2>
                        {% if page.rejection_reason %}
                        <ul>
                        {% for reason in page.rejection_reason %}
                            <li>{{ reason }}</li>
                        {% endfor %}
                        </ul>
                        {% endif %}
                        
                        {% if page.alternative_accepted %}
                        <p class="accepted-alternative">
                            <strong>Accepted Alternative:</strong>
                            {% assign alt_fact = site.facts | where: "name", page.alternative_accepted | first %}
                            {% if alt_fact %}
                            <a href="{{ alt_fact.url }}">{{ alt_fact.title }}</a>
                            {% else %}
                            {{ page.alternative_accepted }}
                            {% endif %}
                        </p>
                        {% endif %}
                    </section>
                    {% endif %}

                    <!-- Rejected Alternatives (for accepted facts) -->
                    {% if page.rejected_alternatives %}
                    <section class="fact-rejected">
                        <h2>Rejected Alternatives</h2>
                        <ul>
                        {% for alt in page.rejected_alternatives %}
                            <li>{{ alt }}</li>
                        {% endfor %}
                        </ul>
                    </section>
                    {% endif %}

                    <!-- Additional content from markdown -->
                    {% if content != "" %}
                    <section class="fact-additional">
                        {{ content }}
                    </section>
                    {% endif %}
                </article>
            </main>

            <hr/>
            {%- include footer.html -%}
        </div>
        <button class="scroll-to-top" id="scroll-to-top"><i class="fa fa-chevron-up"></i></button>
    </div>
    
    <script>
        document.getElementById("scroll-to-top").addEventListener("click", function() {
            window.scrollTo({top: 0, left: 0, behavior: 'smooth'});
        });
    </script>
    {%- include contextmenu.html -%}
    {%- include analytics.html -%}
</body>
</html>
